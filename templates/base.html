<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Coventry Research Search{% endblock %}</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fraunces:ital,opsz,wght@0,9..144,300;0,9..144,400;0,9..144,500;0,9..144,600;0,9..144,700;1,9..144,400&family=Source+Sans+3:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
    
    <style>
        :root {
            --font-display: 'Fraunces', Georgia, serif;
            --font-body: 'Source Sans 3', -apple-system, sans-serif;
            --space-xs: 0.25rem; --space-sm: 0.5rem; --space-md: 1rem;
            --space-lg: 1.5rem; --space-xl: 2rem; --space-2xl: 3rem; --space-3xl: 4rem;
            --radius-sm: 6px; --radius-md: 12px; --radius-lg: 20px; --radius-xl: 28px; --radius-full: 9999px;
            --transition-fast: 150ms ease; --transition-base: 250ms ease;
            --transition-slow: 400ms cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        [data-theme="light"] {
            --color-bg-primary: #FAFAF8; --color-bg-secondary: #FFFFFF;
            --color-bg-tertiary: #F5F4F0; --color-bg-accent: #E8E6DF;
            --color-text-primary: #1A1A18; --color-text-secondary: #5C5C58;
            --color-text-tertiary: #8A8A86; --color-text-inverse: #FAFAF8;
            --color-brand-primary: #2D5A3D; --color-brand-secondary: #4A7C59;
            --color-brand-accent: #C4A747; --color-brand-light: #E8F0EB;
            --color-border-primary: #E0DED6; --color-border-secondary: #D0CEC6;
            --color-success: #2D5A3D; --color-warning: #B8860B;
            --color-error: #A63D40; --color-info: #3D5A80;
            --shadow-sm: 0 1px 3px rgba(26, 26, 24, 0.04);
            --shadow-md: 0 4px 12px rgba(26, 26, 24, 0.06);
            --shadow-lg: 0 8px 30px rgba(26, 26, 24, 0.08);
            --shadow-xl: 0 20px 50px rgba(26, 26, 24, 0.12);
            --glass-bg: rgba(255, 255, 255, 0.6);
            --glass-bg-heavy: rgba(255, 255, 255, 0.85);
            --glass-border: rgba(255, 255, 255, 0.4);
            --glass-shadow: 0 8px 32px rgba(26, 26, 24, 0.1), inset 0 0 0 1px rgba(255,255,255,0.1);
        }
        
        [data-theme="dark"] {
            --color-bg-primary: #141413; --color-bg-secondary: #1C1C1A;
            --color-bg-tertiary: #242422; --color-bg-accent: #2C2C29;
            --color-text-primary: #F5F4F0; --color-text-secondary: #A8A8A4;
            --color-text-tertiary: #6C6C68; --color-text-inverse: #1A1A18;
            --color-brand-primary: #6DB87F; --color-brand-secondary: #8FCC9C;
            --color-brand-accent: #D4B94A; --color-brand-light: #1E2A20;
            --color-border-primary: #2C2C29; --color-border-secondary: #3C3C38;
            --color-success: #6DB87F; --color-warning: #D4B94A;
            --color-error: #E07A7D; --color-info: #7BA3C9;
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.2);
            --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.25);
            --shadow-lg: 0 8px 30px rgba(0, 0, 0, 0.3);
            --shadow-xl: 0 20px 50px rgba(0, 0, 0, 0.4);
            --glass-bg: rgba(28, 28, 26, 0.6);
            --glass-bg-heavy: rgba(28, 28, 26, 0.85);
            --glass-border: rgba(60, 60, 56, 0.4);
            --glass-shadow: 0 8px 32px rgba(0, 0, 0, 0.3), inset 0 0 0 1px rgba(255,255,255,0.03);
        }
        
        *, *::before, *::after { box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        
        body {
            margin: 0; font-family: var(--font-body); font-size: 16px; line-height: 1.6;
            color: var(--color-text-primary); background: var(--color-bg-primary);
            transition: background var(--transition-slow), color var(--transition-slow);
            min-height: 100vh; display: flex; flex-direction: column;
        }
        
        /* Glass Utilities */
        .glass {
            background: var(--glass-bg);
            backdrop-filter: blur(16px) saturate(180%);
            -webkit-backdrop-filter: blur(16px) saturate(180%);
            border: 1px solid var(--glass-border);
            box-shadow: var(--glass-shadow);
        }
        
        .glass-heavy {
            background: var(--glass-bg-heavy);
            backdrop-filter: blur(24px) saturate(180%);
            -webkit-backdrop-filter: blur(24px) saturate(180%);
            border: 1px solid var(--glass-border);
            box-shadow: var(--glass-shadow);
        }
        
        .glass-card {
            background: var(--glass-bg);
            backdrop-filter: blur(16px) saturate(180%);
            -webkit-backdrop-filter: blur(16px) saturate(180%);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-lg);
            box-shadow: var(--glass-shadow);
            transition: all var(--transition-base);
        }
        
        .glass-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-xl), inset 0 0 0 1px rgba(255,255,255,0.1);
        }
        
        /* Navigation */
        .nav-wrapper {
            position: sticky; top: 0; z-index: 100;
            background: var(--glass-bg-heavy);
            backdrop-filter: blur(24px) saturate(180%);
            -webkit-backdrop-filter: blur(24px) saturate(180%);
            border-bottom: 1px solid var(--glass-border);
        }
        
        .nav-container {
            max-width: 1280px; margin: 0 auto; padding: var(--space-md) var(--space-xl);
            display: flex; align-items: center; justify-content: space-between; gap: var(--space-xl);
        }
        
        .nav-brand {
            display: flex; align-items: center; gap: var(--space-sm); text-decoration: none;
            color: var(--color-text-primary); font-family: var(--font-display);
            font-weight: 600; font-size: 1.25rem; transition: all var(--transition-fast);
        }
        .nav-brand:hover { color: var(--color-brand-primary); }
        
        .nav-brand-icon {
            width: 36px; height: 36px;
            background: linear-gradient(135deg, var(--color-brand-primary), var(--color-brand-secondary));
            border-radius: var(--radius-sm); display: flex; align-items: center; justify-content: center;
            color: white; font-size: 1rem; box-shadow: 0 2px 8px rgba(45, 90, 61, 0.3);
        }
        
        .nav-links { display: flex; align-items: center; gap: var(--space-xs); }
        
        .nav-link {
            display: flex; align-items: center; gap: var(--space-xs);
            padding: var(--space-sm) var(--space-md); text-decoration: none;
            color: var(--color-text-secondary); font-weight: 500; font-size: 0.9375rem;
            border-radius: var(--radius-sm); transition: all var(--transition-fast);
        }
        .nav-link:hover, .nav-link.active { color: var(--color-brand-primary); background: var(--color-brand-light); }
        
        .nav-right { display: flex; align-items: center; gap: var(--space-md); }
        
        .nav-stat {
            display: flex; align-items: center; gap: var(--space-xs);
            padding: var(--space-xs) var(--space-sm);
            background: var(--glass-bg); backdrop-filter: blur(8px);
            border: 1px solid var(--glass-border); border-radius: var(--radius-full);
            font-size: 0.8125rem; color: var(--color-text-secondary);
        }
        .nav-stat-number { font-weight: 600; color: var(--color-brand-primary); }
        
        .theme-toggle {
            width: 44px; height: 44px; border: 1px solid var(--glass-border);
            background: var(--glass-bg); backdrop-filter: blur(8px);
            border-radius: var(--radius-full); cursor: pointer;
            display: flex; align-items: center; justify-content: center;
            color: var(--color-text-secondary); font-size: 1.125rem;
            transition: all var(--transition-fast); position: relative; overflow: hidden;
        }
        .theme-toggle:hover { background: var(--color-bg-accent); color: var(--color-text-primary); transform: scale(1.05); }
        .theme-toggle .icon-sun, .theme-toggle .icon-moon { position: absolute; transition: all var(--transition-base); }
        [data-theme="light"] .icon-sun { opacity: 1; transform: rotate(0); }
        [data-theme="light"] .icon-moon { opacity: 0; transform: rotate(-90deg); }
        [data-theme="dark"] .icon-sun { opacity: 0; transform: rotate(90deg); }
        [data-theme="dark"] .icon-moon { opacity: 1; transform: rotate(0); }
        
        .main-content { flex: 1; max-width: 1280px; width: 100%; margin: 0 auto; padding: var(--space-xl); }
        .main-content.wide { max-width: 1400px; }
        
        /* Flash Messages */
        .flash-container { max-width: 1280px; margin: 0 auto; padding: var(--space-md) var(--space-xl) 0; }
        .flash-message {
            display: flex; align-items: center; gap: var(--space-md);
            padding: var(--space-md) var(--space-lg); border-radius: var(--radius-md);
            margin-bottom: var(--space-md); animation: slideDown 0.4s ease-out;
            backdrop-filter: blur(12px);
        }
        @keyframes slideDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        .flash-message.success { background: rgba(45, 90, 61, 0.15); border: 1px solid var(--color-success); color: var(--color-success); }
        .flash-message.error, .flash-message.danger { background: rgba(166, 61, 64, 0.15); border: 1px solid var(--color-error); color: var(--color-error); }
        .flash-message.warning { background: rgba(184, 134, 11, 0.15); border: 1px solid var(--color-warning); color: var(--color-warning); }
        .flash-message.info { background: rgba(61, 90, 128, 0.15); border: 1px solid var(--color-info); color: var(--color-info); }
        .flash-close { margin-left: auto; background: none; border: none; cursor: pointer; color: inherit; opacity: 0.6; }
        .flash-close:hover { opacity: 1; }
        
        /* Footer */
        .footer {
            background: var(--glass-bg); backdrop-filter: blur(16px);
            border-top: 1px solid var(--glass-border); padding: var(--space-2xl) var(--space-xl); margin-top: auto;
        }
        .footer-content { max-width: 1280px; margin: 0 auto; text-align: center; }
        .footer-text { color: var(--color-text-tertiary); font-size: 0.875rem; margin: 0 0 var(--space-xs); }
        .footer-subtext { color: var(--color-text-tertiary); font-size: 0.8125rem; margin: 0; opacity: 0.8; }
        
        /* Buttons */
        .btn {
            display: inline-flex; align-items: center; justify-content: center; gap: var(--space-sm);
            padding: var(--space-sm) var(--space-lg); font-family: var(--font-body);
            font-size: 0.9375rem; font-weight: 500; border-radius: var(--radius-sm);
            border: none; cursor: pointer; transition: all var(--transition-fast); text-decoration: none;
        }
        .btn-primary { background: linear-gradient(135deg, var(--color-brand-primary), var(--color-brand-secondary)); color: white; box-shadow: 0 2px 8px rgba(45, 90, 61, 0.25); }
        .btn-primary:hover { transform: translateY(-1px); box-shadow: 0 4px 16px rgba(45, 90, 61, 0.35); }
        .btn-secondary { background: var(--glass-bg); backdrop-filter: blur(8px); color: var(--color-text-primary); border: 1px solid var(--color-border-primary); }
        .btn-secondary:hover { background: var(--color-bg-tertiary); border-color: var(--color-brand-primary); color: var(--color-brand-primary); }
        .btn-success { background: linear-gradient(135deg, var(--color-success), #3d7a4d); color: white; }
        .btn-warning { background: linear-gradient(135deg, var(--color-warning), #d4a017); color: white; }
        .btn-info { background: linear-gradient(135deg, var(--color-info), #4a6fa5); color: white; }
        .btn-danger { background: linear-gradient(135deg, var(--color-error), #c44d50); color: white; }
        .btn-outline { background: transparent; border: 1px solid var(--color-border-primary); color: var(--color-text-secondary); }
        .btn-outline:hover { background: var(--color-brand-light); border-color: var(--color-brand-primary); color: var(--color-brand-primary); }
        .btn-sm { padding: var(--space-xs) var(--space-md); font-size: 0.8125rem; }
        .btn-lg { padding: var(--space-md) var(--space-xl); font-size: 1rem; }
        
        /* Forms */
        .form-group { margin-bottom: var(--space-lg); }
        .form-label { display: block; margin-bottom: var(--space-sm); font-weight: 500; color: var(--color-text-primary); font-size: 0.9375rem; }
        .form-input {
            width: 100%; padding: var(--space-md); font-family: var(--font-body); font-size: 1rem;
            color: var(--color-text-primary); background: var(--glass-bg); backdrop-filter: blur(8px);
            border: 1px solid var(--color-border-primary); border-radius: var(--radius-sm);
            transition: all var(--transition-fast); outline: none;
        }
        .form-input:focus { border-color: var(--color-brand-primary); box-shadow: 0 0 0 3px var(--color-brand-light); }
        .form-input::placeholder { color: var(--color-text-tertiary); }
        textarea.form-input { min-height: 150px; resize: vertical; }
        
        /* Badges */
        .badge {
            display: inline-flex; align-items: center; gap: var(--space-xs);
            padding: var(--space-xs) var(--space-sm); font-size: 0.75rem; font-weight: 600;
            border-radius: var(--radius-sm); text-transform: uppercase; letter-spacing: 0.03em;
        }
        .badge-primary { background: var(--color-brand-light); color: var(--color-brand-primary); }
        .badge-success { background: rgba(45, 90, 61, 0.15); color: var(--color-success); }
        .badge-warning { background: rgba(184, 134, 11, 0.15); color: var(--color-warning); }
        .badge-error { background: rgba(166, 61, 64, 0.15); color: var(--color-error); }
        .badge-info { background: rgba(61, 90, 128, 0.15); color: var(--color-info); }
        .badge-neutral { background: var(--color-bg-tertiary); color: var(--color-text-secondary); }
        
        /* Tables */
        .table-container { overflow-x: auto; border-radius: var(--radius-md); border: 1px solid var(--color-border-primary); background: var(--glass-bg); backdrop-filter: blur(8px); }
        .table { width: 100%; border-collapse: collapse; font-size: 0.9375rem; }
        .table th, .table td { padding: var(--space-md); text-align: left; border-bottom: 1px solid var(--color-border-primary); }
        .table th { background: var(--color-bg-tertiary); font-weight: 600; font-size: 0.8125rem; text-transform: uppercase; letter-spacing: 0.03em; color: var(--color-text-secondary); }
        .table tr:last-child td { border-bottom: none; }
        .table tr:hover td { background: var(--color-bg-tertiary); }
        
        /* Progress */
        .progress { height: 8px; background: var(--color-bg-tertiary); border-radius: var(--radius-full); overflow: hidden; }
        .progress-bar { height: 100%; border-radius: var(--radius-full); transition: width var(--transition-slow); }
        .progress-bar-primary { background: linear-gradient(90deg, var(--color-brand-primary), var(--color-brand-secondary)); }
        .progress-bar-success { background: linear-gradient(90deg, var(--color-success), #4a9a5a); }
        .progress-bar-error { background: linear-gradient(90deg, var(--color-error), #c44d50); }
        .progress-bar-info { background: linear-gradient(90deg, var(--color-info), #4a6fa5); }
        
        /* Utilities */
        .container { max-width: 800px; margin: 0 auto; }
        .container-wide { max-width: 1100px; margin: 0 auto; }
        .text-center { text-align: center; }
        .text-muted { color: var(--color-text-tertiary); }
        .text-success { color: var(--color-success); }
        .text-warning { color: var(--color-warning); }
        .text-error { color: var(--color-error); }
        .text-info { color: var(--color-info); }
        .mt-sm { margin-top: var(--space-sm); } .mt-md { margin-top: var(--space-md); }
        .mt-lg { margin-top: var(--space-lg); } .mt-xl { margin-top: var(--space-xl); }
        .mb-sm { margin-bottom: var(--space-sm); } .mb-md { margin-bottom: var(--space-md); }
        .mb-lg { margin-bottom: var(--space-lg); } .mb-xl { margin-bottom: var(--space-xl); }
        
        .grid-2 { display: grid; grid-template-columns: repeat(2, 1fr); gap: var(--space-lg); }
        .grid-3 { display: grid; grid-template-columns: repeat(3, 1fr); gap: var(--space-lg); }
        .grid-4 { display: grid; grid-template-columns: repeat(4, 1fr); gap: var(--space-lg); }
        
        /* Animations */
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes pulse { 0%, 100% { opacity: 1; transform: scale(1); } 50% { opacity: 0.6; transform: scale(1.1); } }
        .animate-fade-in { animation: fadeInUp 0.5s ease-out; }
        
        /* Mobile */
        .nav-mobile-toggle { display: none; background: none; border: none; color: var(--color-text-primary); font-size: 1.5rem; cursor: pointer; padding: var(--space-sm); }
        
        @media (max-width: 768px) {
            .nav-container { padding: var(--space-sm) var(--space-md); }
            .nav-links { display: none; position: absolute; top: 100%; left: 0; right: 0; background: var(--glass-bg-heavy); backdrop-filter: blur(24px); border-bottom: 1px solid var(--glass-border); flex-direction: column; padding: var(--space-md); }
            .nav-links.open { display: flex; }
            .nav-mobile-toggle { display: block; }
            .nav-stat { display: none; }
            .main-content { padding: var(--space-md); }
            .grid-2, .grid-3, .grid-4 { grid-template-columns: 1fr; }
        }
    </style>
    {% block extra_css %}{% endblock %}
</head>
<body>
    <nav class="nav-wrapper">
        <div class="nav-container">
            <a href="{{ url_for('index') }}" class="nav-brand">
                <span class="nav-brand-icon"><i class="bi bi-journal-richtext"></i></span>
                <span>CU Research</span>
            </a>
            <button class="nav-mobile-toggle" onclick="toggleMobileNav()"><i class="bi bi-list"></i></button>
            <div class="nav-links" id="navLinks">
                <a href="{{ url_for('index') }}" class="nav-link {% if request.endpoint == 'index' %}active{% endif %}"><i class="bi bi-house-door"></i><span>Home</span></a>
                <a href="{{ url_for('search') }}" class="nav-link {% if request.endpoint == 'search' %}active{% endif %}"><i class="bi bi-search"></i><span>Search</span></a>
                <a href="{{ url_for('classify') }}" class="nav-link {% if request.endpoint == 'classify' %}active{% endif %}"><i class="bi bi-tags"></i><span>Classify</span></a>
            </div>
            <div class="nav-right">
                <div class="nav-stat">
                    <i class="bi bi-journal-bookmark"></i>
                    <span class="nav-stat-number">{{ stats.total_documents if stats else 0 }}</span>
                    <span>indexed</span>
                </div>
                <button class="theme-toggle" onclick="toggleTheme()">
                    <i class="bi bi-sun-fill icon-sun"></i>
                    <i class="bi bi-moon-fill icon-moon"></i>
                </button>
            </div>
        </div>
    </nav>
    
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            <div class="flash-container">
                {% for category, message in messages %}
                    <div class="flash-message {{ category }}">
                        <i class="bi bi-{% if category == 'success' %}check-circle{% elif category == 'error' or category == 'danger' %}exclamation-circle{% elif category == 'warning' %}exclamation-triangle{% else %}info-circle{% endif %}"></i>
                        <span>{{ message }}</span>
                        <button class="flash-close" onclick="this.parentElement.remove()"><i class="bi bi-x-lg"></i></button>
                    </div>
                {% endfor %}
            </div>
        {% endif %}
    {% endwith %}
    
    <main class="main-content {% block main_class %}{% endblock %}">
        {% block content %}{% endblock %}
    </main>
    
    <footer class="footer">
        <div class="footer-content">
            <p class="footer-text">Vertical Academic Search Engine — Information Retrieval Coursework</p>
            <p class="footer-subtext">Coventry University • Research Centre for Computational Science and Mathematical Modelling</p>
        </div>
    </footer>
    
    <script>
        function getPreferredTheme() { const s = localStorage.getItem('theme'); return s || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light'); }
        function setTheme(t) { document.documentElement.setAttribute('data-theme', t); localStorage.setItem('theme', t); }
        function toggleTheme() { setTheme(document.documentElement.getAttribute('data-theme') === 'dark' ? 'light' : 'dark'); }
        setTheme(getPreferredTheme());
        function toggleMobileNav() { document.getElementById('navLinks').classList.toggle('open'); }
        setTimeout(() => { document.querySelectorAll('.flash-message').forEach(m => { m.style.opacity = '0'; setTimeout(() => m.remove(), 300); }); }, 5000);
    </script>
    {% block extra_js %}{% endblock %}
</body>
</html>